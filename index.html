<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
<meta name="referrer" content="no-referrer">
<meta name="color-scheme" content="dark">
<title>Competitive Heatmap Visualizer</title>
<style>
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
font-size: 16px;
-webkit-text-size-adjust: 100%;
}

body {
font-family: -apple-system, BlinkMacSystemFont, “Segoe UI”, Roboto, Helvetica, Arial, sans-serif;
background-color: #0f0f0f;
color: #f0f0f0;
line-height: 1.6;
min-height: 100vh;
padding: 16px;
}

.container {
max-width: 900px;
margin: 0 auto;
}

header {
text-align: center;
margin-bottom: 24px;
}

h1 {
font-size: 1.5rem;
font-weight: 700;
color: #a78bfa;
margin-bottom: 8px;
}

.subtitle {
color: #9ca3af;
font-size: 0.9rem;
}

.card {
background-color: #1a1a1a;
border: 1px solid #333333;
border-radius: 12px;
padding: 16px;
margin-bottom: 16px;
}

.card-title {
font-size: 1rem;
font-weight: 600;
color: #f0f0f0;
margin-bottom: 12px;
display: flex;
align-items: center;
gap: 8px;
}

.card-description {
font-size: 0.85rem;
color: #9ca3af;
margin-bottom: 12px;
}

.prompt-box {
background-color: #252525;
border: 1px solid #404040;
border-radius: 8px;
padding: 12px;
font-family: “SF Mono”, Monaco, “Cascadia Code”, “Courier New”, monospace;
font-size: 0.8rem;
color: #e5e5e5;
white-space: pre-wrap;
word-break: break-word;
overflow-x: auto;
margin-bottom: 12px;
}

.btn {
display: block;
width: 100%;
padding: 14px 20px;
font-size: 1rem;
font-weight: 600;
text-align: center;
border: none;
border-radius: 8px;
cursor: pointer;
-webkit-appearance: none;
appearance: none;
touch-action: manipulation;
}

.btn-primary {
background-color: #6366f1;
color: #ffffff;
}

.btn-primary:active {
background-color: #4f46e5;
}

.btn-secondary {
background-color: #374151;
color: #ffffff;
margin-top: 10px;
}

.btn-secondary:active {
background-color: #4b5563;
}

.input-label {
display: block;
font-size: 0.9rem;
font-weight: 500;
color: #e5e5e5;
margin-bottom: 8px;
}

.textarea-input {
display: block;
width: 100%;
min-height: 180px;
padding: 12px;
font-family: “SF Mono”, Monaco, “Cascadia Code”, “Courier New”, monospace;
font-size: 0.85rem;
color: #f0f0f0;
background-color: #252525;
border: 1px solid #404040;
border-radius: 8px;
resize: vertical;
-webkit-appearance: none;
appearance: none;
}

.textarea-input:focus {
outline: none;
border-color: #6366f1;
}

.link-btn {
display: block;
background: none;
border: none;
color: #818cf8;
font-size: 0.85rem;
padding: 10px 0;
cursor: pointer;
text-decoration: underline;
text-align: left;
-webkit-appearance: none;
appearance: none;
}

.btn-row {
display: flex;
flex-direction: column;
gap: 10px;
margin-top: 12px;
}

.status-box {
padding: 12px;
border-radius: 8px;
font-size: 0.9rem;
margin-top: 12px;
display: none;
}

.status-box.show {
display: block;
}

.status-box.error {
background-color: rgba(239, 68, 68, 0.15);
border: 1px solid #ef4444;
color: #fca5a5;
}

.status-box.success {
background-color: rgba(34, 197, 94, 0.15);
border: 1px solid #22c55e;
color: #86efac;
}

.status-box.warning {
background-color: rgba(245, 158, 11, 0.15);
border: 1px solid #f59e0b;
color: #fcd34d;
}

.heatmap-card {
display: none;
}

.heatmap-card.show {
display: block;
}

.legend-row {
display: flex;
align-items: center;
gap: 6px;
margin-bottom: 12px;
flex-wrap: wrap;
font-size: 0.8rem;
color: #9ca3af;
}

.legend-colors {
display: flex;
gap: 4px;
}

.legend-box {
width: 28px;
height: 24px;
border-radius: 4px;
display: flex;
align-items: center;
justify-content: center;
font-size: 0.75rem;
font-weight: 700;
color: #ffffff;
}

.heatmap-scroll {
overflow-x: auto;
-webkit-overflow-scrolling: touch;
}

.heatmap-grid {
border-collapse: separate;
border-spacing: 4px;
min-width: 100%;
}

.heatmap-grid th,
.heatmap-grid td {
padding: 10px 8px;
text-align: center;
border-radius: 6px;
font-size: 0.8rem;
}

.heatmap-grid th {
background-color: #252525;
color: #9ca3af;
font-weight: 600;
}

.heatmap-grid th.corner-cell {
background-color: transparent;
}

.heatmap-grid td.row-label {
background-color: #252525;
color: #e5e5e5;
font-weight: 500;
text-align: left;
white-space: nowrap;
}

.heatmap-grid td.score-cell {
font-weight: 700;
color: #ffffff;
cursor: pointer;
min-width: 44px;
}

.popup-overlay {
display: none;
position: fixed;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-color: rgba(0, 0, 0, 0.6);
z-index: 1000;
padding: 20px;
overflow-y: auto;
}

.popup-overlay.show {
display: flex;
align-items: center;
justify-content: center;
}

.popup-content {
background-color: #1a1a1a;
border: 1px solid #404040;
border-radius: 12px;
padding: 20px;
max-width: 320px;
width: 100%;
position: relative;
}

.popup-close {
position: absolute;
top: 12px;
right: 12px;
background: none;
border: none;
color: #9ca3af;
font-size: 1.5rem;
cursor: pointer;
padding: 4px;
line-height: 1;
}

.popup-title {
font-size: 1rem;
font-weight: 600;
color: #f0f0f0;
margin-bottom: 4px;
padding-right: 30px;
}

.popup-score {
font-size: 0.85rem;
color: #9ca3af;
margin-bottom: 12px;
}

.popup-comment {
font-size: 0.9rem;
color: #e5e5e5;
line-height: 1.5;
}

.privacy-box {
background-color: #1a1a1a;
border: 1px solid #333333;
border-radius: 8px;
padding: 16px;
margin-top: 24px;
font-size: 0.8rem;
color: #9ca3af;
}

.privacy-box h3 {
font-size: 0.85rem;
color: #e5e5e5;
margin-bottom: 8px;
}

.privacy-box ul {
margin: 8px 0 0 0;
padding-left: 20px;
}

.privacy-box li {
margin-bottom: 4px;
}

@media (min-width: 600px) {
.btn-row {
flex-direction: row;
}

.btn-row .btn {
flex: 1;
}
}
</style>

</head>
<body>

<div class="container">
  <header>
    <h1>Competitive Heatmap Visualizer</h1>
    <p class="subtitle">Transform LLM competitive analysis into visual insights</p>
  </header>

  <main>
    <section class="card">
      <h2 class="card-title">Prompt Recipe</h2>
      <p class="card-description">Copy this prompt, customize it, and send to your preferred LLM:</p>
      <div class="prompt-box" id="promptText">Compare [Company A, Company B, Company C] on these features: [Feature 1, Feature 2, Feature 3].

Return ONLY a JSON code block with no other text. Use this exact format:

```json
{
  "competitors": {
    "Company A": {
      "Feature 1": {"score": 4, "comment": "Brief analysis"},
      "Feature 2": {"score": 3, "comment": "Brief analysis"}
    },
    "Company B": {
      "Feature 1": {"score": 2, "comment": "Brief analysis"},
      "Feature 2": {"score": 5, "comment": "Brief analysis"}
    }
  }
}
```

Rules:

- Scores must be integers from 1 (worst) to 5 (best)
- Include a brief comment explaining each score
- Output ONLY the JSON code block, nothing else</div>
  <button type="button" class="btn btn-primary" id="copyBtn">Copy Prompt to Clipboard</button>
  
    </section>
  
    <section class="card">
      <h2 class="card-title">Paste LLM Output</h2>
      <label class="input-label" for="jsonInput">Paste the JSON response from your LLM:</label>
      <textarea id="jsonInput" class="textarea-input" placeholder="Paste your JSON here..."></textarea>
      <button type="button" class="link-btn" id="exampleBtn">Load example data</button>
      <div class="btn-row">
        <button type="button" class="btn btn-primary" id="generateBtn">Generate Heatmap</button>
        <button type="button" class="btn btn-secondary" id="clearBtn">Clear</button>
      </div>
      <div class="status-box" id="statusBox" role="status"></div>
    </section>
  
    <section class="card heatmap-card" id="heatmapCard">
      <h2 class="card-title">Competitive Heatmap</h2>
      <div class="legend-row">
        <span>Score:</span>
        <div class="legend-colors" id="legendColors"></div>
        <span>(1=Weak, 5=Strong)</span>
      </div>
      <div class="heatmap-scroll">
        <table class="heatmap-grid" id="heatmapTable"></table>
      </div>
    </section>
  </main>
  
  <footer class="privacy-box">
    <h3>Privacy Notice</h3>
    <p>This tool processes data locally in your browser. No data is uploaded to any server.</p>
    <ul>
      <li>No uploads - all processing happens locally</li>
      <li>No cookies or tracking</li>
      <li>No account required</li>
      <li>No background network requests</li>
    </ul>
  </footer>

</div>

<div class="popup-overlay" id="popupOverlay">
  <div class="popup-content">
    <button type="button" class="popup-close" id="popupClose" aria-label="Close">&times;</button>
    <div class="popup-title" id="popupTitle"></div>
    <div class="popup-score" id="popupScore"></div>
    <div class="popup-comment" id="popupComment"></div>
  </div>
</div>

<script>
(function() {
  "use strict";

  var MAX_COMPETITORS = 20;
  var MAX_FEATURES = 30;
  var MAX_INPUT = 102400;

  var promptText = document.getElementById("promptText");
  var copyBtn = document.getElementById("copyBtn");
  var jsonInput = document.getElementById("jsonInput");
  var exampleBtn = document.getElementById("exampleBtn");
  var generateBtn = document.getElementById("generateBtn");
  var clearBtn = document.getElementById("clearBtn");
  var statusBox = document.getElementById("statusBox");
  var heatmapCard = document.getElementById("heatmapCard");
  var heatmapTable = document.getElementById("heatmapTable");
  var legendColors = document.getElementById("legendColors");
  var popupOverlay = document.getElementById("popupOverlay");
  var popupClose = document.getElementById("popupClose");
  var popupTitle = document.getElementById("popupTitle");
  var popupScore = document.getElementById("popupScore");
  var popupComment = document.getElementById("popupComment");

  var exampleData = {
    competitors: {
      "Slack": {
        "Pricing": {score: 3, comment: "Mid-range pricing. Free tier available but limited."},
        "Integrations": {score: 5, comment: "Excellent ecosystem with 2,400+ apps."},
        "Search": {score: 4, comment: "Powerful search with filters."},
        "Video Calls": {score: 3, comment: "Huddles feature is good for quick calls."}
      },
      "Microsoft Teams": {
        "Pricing": {score: 4, comment: "Bundled with Microsoft 365. Great value."},
        "Integrations": {score: 4, comment: "Strong Microsoft ecosystem integration."},
        "Search": {score: 3, comment: "Basic search functionality."},
        "Video Calls": {score: 5, comment: "Excellent video conferencing features."}
      },
      "Discord": {
        "Pricing": {score: 5, comment: "Generous free tier."},
        "Integrations": {score: 3, comment: "Bot ecosystem is strong but limited business tools."},
        "Search": {score: 2, comment: "Basic search. No advanced filters."},
        "Video Calls": {score: 4, comment: "Good quality video and screen sharing."}
      },
      "Zoom": {
        "Pricing": {score: 3, comment: "Free tier has 40-min limit."},
        "Integrations": {score: 4, comment: "Good calendar and productivity integrations."},
        "Search": {score: 2, comment: "Limited chat search."},
        "Video Calls": {score: 5, comment: "Industry-leading video quality."}
      }
    }
  };

  var scoreColors = {
    1: "#b91c1c",
    2: "#c2410c",
    3: "#a16207",
    4: "#4d7c0f",
    5: "#15803d"
  };

  function init() {
    buildLegend();
    copyBtn.addEventListener("click", handleCopy);
    exampleBtn.addEventListener("click", handleExample);
    generateBtn.addEventListener("click", handleGenerate);
    clearBtn.addEventListener("click", handleClear);
    popupClose.addEventListener("click", hidePopup);
    popupOverlay.addEventListener("click", function(e) {
      if (e.target === popupOverlay) {
        hidePopup();
      }
    });
    document.addEventListener("keydown", function(e) {
      if (e.key === "Escape") {
        hidePopup();
      }
    });
  }

  function buildLegend() {
    for (var i = 1; i <= 5; i++) {
      var box = document.createElement("div");
      box.className = "legend-box";
      box.style.backgroundColor = scoreColors[i];
      box.textContent = i;
      legendColors.appendChild(box);
    }
  }

  function handleCopy() {
    var text = promptText.textContent;
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(text).then(function() {
        copyBtn.textContent = "Copied!";
        setTimeout(function() {
          copyBtn.textContent = "Copy Prompt to Clipboard";
        }, 2000);
      }).catch(function() {
        copyBtn.textContent = "Copy failed";
        setTimeout(function() {
          copyBtn.textContent = "Copy Prompt to Clipboard";
        }, 2000);
      });
    } else {
      copyBtn.textContent = "Copy not supported";
      setTimeout(function() {
        copyBtn.textContent = "Copy Prompt to Clipboard";
      }, 2000);
    }
  }

  function handleExample() {
    jsonInput.value = JSON.stringify(exampleData, null, 2);
    showStatus("Example data loaded. Click Generate Heatmap.", "success");
  }

  function handleGenerate() {
    var input = jsonInput.value.trim();

    if (!input) {
      showStatus("Please paste JSON data first.", "error");
      return;
    }

    if (input.length > MAX_INPUT) {
      showStatus("Input too large. Max 100KB.", "error");
      return;
    }

    var data;
    try {
      data = parseJSON(input);
    } catch (e) {
      showStatus("Invalid JSON: " + e.message, "error");
      return;
    }

    var validation = validateData(data);
    if (!validation.valid) {
      showStatus(validation.error, "error");
      return;
    }

    if (validation.warnings.length > 0) {
      showStatus("Generated with warnings: " + validation.warnings.join("; "), "warning");
    } else {
      showStatus("Heatmap generated!", "success");
    }

    renderHeatmap(data);
  }

  function parseJSON(input) {
    var str = input;
    var match = input.match(/```(?:json)?\s*([\s\S]*?)```/);
    if (match) {
      str = match[1].trim();
    }
    return JSON.parse(str);
  }

  function validateData(data) {
    var result = {valid: false, error: "", warnings: []};

    if (!data || typeof data !== "object") {
      result.error = "Data must be a JSON object.";
      return result;
    }

    if (!data.competitors || typeof data.competitors !== "object") {
      result.error = "Missing competitors object.";
      return result;
    }

    var comps = Object.keys(data.competitors);
    if (comps.length === 0) {
      result.error = "No competitors found.";
      return result;
    }

    if (comps.length > MAX_COMPETITORS) {
      result.error = "Too many competitors. Max " + MAX_COMPETITORS + ".";
      return result;
    }

    var features = new Set();
    for (var i = 0; i < comps.length; i++) {
      var compData = data.competitors[comps[i]];
      if (!compData || typeof compData !== "object") {
        result.error = "Invalid data for " + comps[i];
        return result;
      }
      var feats = Object.keys(compData);
      for (var j = 0; j < feats.length; j++) {
        features.add(feats[j]);
      }
    }

    if (features.size === 0) {
      result.error = "No features found.";
      return result;
    }

    if (features.size > MAX_FEATURES) {
      result.error = "Too many features. Max " + MAX_FEATURES + ".";
      return result;
    }

    result.valid = true;
    return result;
  }

  function renderHeatmap(data) {
    var comps = Object.keys(data.competitors);
    var featureSet = new Set();
    for (var i = 0; i < comps.length; i++) {
      var feats = Object.keys(data.competitors[comps[i]]);
      for (var j = 0; j < feats.length; j++) {
        featureSet.add(feats[j]);
      }
    }
    var features = Array.from(featureSet);

    heatmapTable.innerHTML = "";

    var thead = document.createElement("thead");
    var headerRow = document.createElement("tr");
    
    var cornerTh = document.createElement("th");
    cornerTh.className = "corner-cell";
    headerRow.appendChild(cornerTh);

    for (var f = 0; f < features.length; f++) {
      var th = document.createElement("th");
      th.textContent = truncate(features[f], 20);
      th.title = features[f];
      headerRow.appendChild(th);
    }
    thead.appendChild(headerRow);
    heatmapTable.appendChild(thead);

    var tbody = document.createElement("tbody");
    for (var c = 0; c < comps.length; c++) {
      var row = document.createElement("tr");
      
      var labelTd = document.createElement("td");
      labelTd.className = "row-label";
      labelTd.textContent = truncate(comps[c], 25);
      labelTd.title = comps[c];
      row.appendChild(labelTd);

      for (var ff = 0; ff < features.length; ff++) {
        var td = document.createElement("td");
        td.className = "score-cell";

        var featData = data.competitors[comps[c]][features[ff]];
        var score = 0;
        var comment = "No data";

        if (featData && typeof featData === "object") {
          score = parseInt(featData.score, 10) || 0;
          if (score < 1) score = 1;
          if (score > 5) score = 5;
          comment = featData.comment || "No comment";
        }

        if (score > 0) {
          td.style.backgroundColor = scoreColors[score];
          td.textContent = score;
        } else {
          td.style.backgroundColor = "#374151";
          td.textContent = "-";
        }

        td.setAttribute("data-comp", comps[c]);
        td.setAttribute("data-feat", features[ff]);
        td.setAttribute("data-score", score);
        td.setAttribute("data-comment", comment);

        td.addEventListener("click", handleCellClick);

        row.appendChild(td);
      }
      tbody.appendChild(row);
    }
    heatmapTable.appendChild(tbody);

    heatmapCard.classList.add("show");
    heatmapCard.scrollIntoView({behavior: "smooth", block: "nearest"});
  }

  function handleCellClick(e) {
    var cell = e.currentTarget;
    var comp = cell.getAttribute("data-comp");
    var feat = cell.getAttribute("data-feat");
    var score = cell.getAttribute("data-score");
    var comment = cell.getAttribute("data-comment");

    popupTitle.textContent = comp + " - " + feat;
    popupScore.textContent = "Score: " + score + "/5";
    popupComment.textContent = comment;

    popupOverlay.classList.add("show");
  }

  function hidePopup() {
    popupOverlay.classList.remove("show");
  }

  function handleClear() {
    jsonInput.value = "";
    heatmapCard.classList.remove("show");
    heatmapTable.innerHTML = "";
    hidePopup();
    showStatus("Cleared.", "success");
  }

  function showStatus(msg, type) {
    statusBox.textContent = msg;
    statusBox.className = "status-box show " + type;
  }

  function truncate(str, len) {
    if (!str) return "";
    if (str.length <= len) return str;
    return str.substring(0, len - 1) + "...";
  }

  init();
})();
</script>

</body>
</html>
